# Ścieżki do plików
$inputFile = "C:\ścieżka_do_pliku\requests.csv"
$outputFile = "C:\ścieżka_do_pliku\tr_seq_requests.txt"

# Wczytaj dane jako zwykły tekst, bez zakładania struktury CSV
$data = Get-Content -Path $inputFile

# Funkcja do wydobywania wartości z tagów <tr_seq>
function Extract-TrSeq {
    param ([string]$Text)
    # Wyrażenie regularne, które dopasowuje wszystkie <tr_seq>...</tr_seq>
    $pattern = "<tr_seq>(.*?)</tr_seq>"
    [regex]::Matches($Text, $pattern) | ForEach-Object { $_.Groups[1].Value }
}

# Wyodrębnij wszystkie wystąpienia <tr_seq> w pliku
$allTrSeq = @()
foreach ($line in $data) {
    $allTrSeq += Extract-TrSeq $line
}

# Usuń duplikaty i zapisz wyniki do pliku
$allTrSeq = $allTrSeq | Sort-Object -Unique
$allTrSeq | Set-Content -Path $outputFile

Write-Host "Znaleziono $($allTrSeq.Count) wartości tr_seq. Wyniki zapisano do $outputFile."