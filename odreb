# Wczytaj dane z pliku CSV
$requests = Import-Csv -Path "C:\ścieżka_do_pliku\requests.csv" -Header "data"

# Funkcja do wydobywania wartości z tagu <tr_seq>
function Extract-TrSeq {
    param ([string]$Text)
    # Usuń podwójne cudzysłowy i wydobądź wartość z <tr_seq>
    $Text = $Text -replace '"', '' # Usuń podwójne cudzysłowy
    $pattern = "<tr_seq>(.*?)</tr_seq>"
    if ($Text -match $pattern) {
        return $Matches[1]
    }
    return $null
}

# Wyodrębnij wszystkie wartości tr_seq
$trSeqValues = $requests | ForEach-Object {
    Extract-TrSeq $_.data
} | Where-Object { $_ -ne $null } # Filtrujemy, aby usunąć puste wartości

# Zapisz wartości tr_seq do pliku tekstowego
$trSeqValues | Set-Content -Path "C:\ścieżka_do_pliku\tr_seq_requests.txt"

Write-Host "Zapisano $($trSeqValues.Count) wartości tr_seq do pliku tr_seq_requests.txt."